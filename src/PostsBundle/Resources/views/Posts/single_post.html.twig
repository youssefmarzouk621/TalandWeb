{% extends "default/LayoutFront.html.twig" %}


{% block section %}

    <div class="container">
        <div style="box-shadow: 0 0 20px 0 rgba(0, 0, 0, 0.15);border-radius: 14px;margin-bottom: 14px;" class="row">

            <div style="display: flex;flex-flow: row wrap;justify-content: center;box-shadow: 0 0 20px 0 rgba(0, 0, 0, 0.07);" class="col-lg-8">
                    <img style="border-radius: 10px;height: 600px;margin-top: 35px;margin-bottom: 35px;" src="{{ asset('uploads/posts/' ~ single_post.imageName) }}" alt="" class="img-fluid">
            </div>




            <div class="col-lg-4">

                    <div style="height:300px;" class="col">
                        <div style="margin-top: 20px;margin-bottom: 5px;" class="media border-0">
                            <div class="media-left pr-1">
                                <span class="avatar avatar-md avatar-online">
                                    <img style="height: 50px;margin-right: 10px;" class="media-object rounded-circle" src="{{ asset('uploads/posts/' ~ single_post.idu.imageName) }}" alt="Generic placeholder image">
                                    <i></i>
                                </span>
                            </div>
                            <div class="media-body w-100">
                                <span class="list-group-item-heading">{{ single_post.idu.firstname }} {{ single_post.idu.lastname }}

                                </span>
                                <p class="list-group-item-text mb-0">
                                    <span class="blue-grey lighten-2 font-small-3"> @{{ single_post.idu.username }} </span>
                                </p>

                            </div>

                        </div>
                        <div style="margin-bottom: 10px;" class="media border-0">
                            <h7>{{ single_post.description }}</h7>
                        </div>
                        <div style="margin-bottom: 30px;" class="media border-0">
                            <h7>Liked by</h7> <h6 style="margin-top: 2px;margin-right: 3px;margin-left: 3px;"><img style="height: 20px;margin-right: 2px;" class="media-object rounded-circle" src="{{ asset('uploads/posts/' ~ reacts[0].idu.imageName) }}" alt="">{{ reacts[0].idu.firstname }}</h6><h7>And by</h7><h6 style="margin-top: 3px;margin-right: 3px;margin-left: 3px;">{{ reacts|length-1 }}</h6><h7>more</h7>
                        </div>
                        <div  style="background: none;border: none;padding-left: 13px;padding-top: 10px;margin-left: -20px;height: 399px;width: 382px;box-shadow: rgba(0, 0, 0, 0.06) -8px 10px 20px 0;margin-bottom: 10px;" class="popular-artists-area nice-scroll">
                            <div class="section-heading text-left wow fadeInUp" data-wow-delay="50ms" style="margin-bottom: 7px ;visibility: visible; animation-delay: 50ms; animation-name: fadeInUp;">
                                <h2>Comments</h2>
                            </div>

                            {% for row in comments  %}
                            <!-- Single comment -->
                                <div class="single-artists d-flex align-items-center wow fadeInUp" data-wow-delay="100ms" style="margin-bottom: 10px;visibility: visible; animation-delay: 100ms; animation-name: fadeInUp;">
                                    <div style="max-width: 51px;" class="thumbnail">
                                        <img src="{{ asset('uploads/posts/' ~ row.idu.imageName) }}" alt="">
                                    </div>
                                    <div class="content-">
                                        <p>{{ row.idu.firstname }} {{ row.idu.lastname }} {% if connected!=null %}
                                                {% if (connected.id==row.idu.id) %}
                                                    <a style="background: none;border:none;color: #00000082;position: relative;top: -2px;" class="btn"><i class="fa fa-times"></i></a>
                                                {% endif %}
                                            {% endif %}</p>
                                        <p style="line-height: 1.2;color: black;">{{ row.contenu }}</p>
                                    </div>
                                </div>
                            {% endfor %}

                        </div>
                        <fieldset style="position: relative;top: 0;left: -20px;width: 300px;" class="form-group">
                            <textarea class="form-control" id="Textarea" rows="2"></textarea>
                        </fieldset>
                        <button onclick="comment({{ single_post.idpost }});" class="btn" style="position: relative;top: -77px;left: 286px;width: 76px;height: 60px;background: none;border: none;box-shadow: inset rgba(0, 0, 0, 0.14) 0px 0px 5px 0px;">Post</button>
                    </div>

            </div>
        </div>
    </div>

{% endblock %}

{% block scripts %}
    <script>
        function comment(idPost) {
            var commentaire=document.getElementById("Textarea").value;
            if (commentaire==""){
                swal({
                    title: 'Stop',
                    text: "You can't submit an empty comment!",
                    type: 'info',
                    confirmButtonColor: '#3085d6',
                    cancelButtonColor: '#d33',
                    confirmButtonText: 'Got it!'
                }).then(function () {}).catch(swal.noop)
            } else{
                var com=document.getElementById("Textarea").value;
                $.ajax({
                    url: 'http://localhost/taland/web/app_dev.php/Posts/AddComment/' + idPost + '/' + com,
                    success: function (data) {
                        console.log("bara orkod");
                        window.location.reload();
                    },
                    error: function (xhr, textStatus, errorThrown) {
                        console.log("Ajax request failed. data :");

                    }
                });
            }
        }
    </script>
    <script src="{{ asset('FrontOffice/js/sweetalert2.all.js')}}" type="text/javascript"></script>
{% endblock %}