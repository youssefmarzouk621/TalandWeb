{% extends "default/LayoutFront.html.twig" %}



{% block section %}


    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.1/css/bootstrap.min.css">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.1/js/bootstrap.min.js"></script>

    <div class="blog-area section-padding-20">

        <div class="container">
            <div class="single-blog-post " data-wow-delay="100ms">
                <div class="blog-content">
                    <div class="post-meta d-flex mb-30">






                    </div>

                    <a href="#">Added :{{ forum.date | date("m/d/Y") }}  </a>

                    <p>Description :{{ forum.descriptionF |raw  }}</p>

                   <a class="btn-danger" id="sin" href="{{ path('signaler',{'id':forum.idF})}}" >Signaler</a>




                    <button id="favoris" onclick="favoris({{ forum.idF }})" class="btn-primary">Add to favorite</button>
<br><br>
                    <div style="text-align: center">
                            <button onclick="vote({{ forum.idF }},1)" style="color: black;border-color: black;" class="btn btn-outline-light"><img style="margin-right: 5px;" class="inner-img" id="upvote" width="20" src="{{ asset('uploads/forum/vote/upvote.png') }}">Upvote<span id="span1" spanval="{{ votes[0] }}" style="margin-left: 5px;" class="badge badge-dark">{{ votes[0] }}</span></button>
                            <button onclick="vote({{ forum.idF }},2)" style="color: black;border-color: black;" class="btn btn-outline-light"><img style="margin-right: 5px;" class="inner-img" id="funny"  width="20" src="{{ asset('uploads/forum/vote/funny.png') }}">Funny<span id="span2" spanval="{{ votes[1] }}" style="margin-left: 5px;" class="badge badge-dark">{{ votes[1] }}</span></button>
                            <button onclick="vote({{ forum.idF }},3)" style="color: black;border-color: black;" class="btn btn-outline-light"><img style="margin-right: 5px;" class="inner-img" id="love"  width="20" src="{{ asset('uploads/forum/vote/love.png') }}">Love<span id="span3" spanval="{{ votes[2] }}" style="margin-left: 5px;" class="badge badge-dark">{{ votes[2] }}</span></button>
                            <button onclick="vote({{ forum.idF }},4)" style="color: black;border-color: black;" class="btn btn-outline-light"><img style="margin-right: 5px;" class="inner-img" id="surprised"  width="20" src="{{ asset('uploads/forum/vote/surprised.png') }}">Surprised<span id="span4" spanval="{{ votes[3] }}" style="margin-left: 5px;" class="badge badge-dark">{{ votes[3] }}</span></button>
                            <button onclick="vote({{ forum.idF }},5)" style="color: black;border-color: black;" class="btn btn-outline-light"><img style="margin-right: 5px;" class="inner-img" id="angry"  width="20" src="{{ asset('uploads/forum/vote/angry.png') }}">Angry<span id="span5" spanval="{{ votes[4] }}" style="margin-left: 5px;" class="badge badge-dark">{{ votes[4] }}</span></button>
                            <button onclick="vote({{ forum.idF }},6)" style="color: black;border-color: black;" class="btn btn-outline-light"><img style="margin-right: 5px;" class="inner-img" id="sad" width="20" src="{{ asset('uploads/forum/vote/sad.png') }}">Sad<span id="span6" spanval="{{ votes[5] }}" style="margin-left: 5px;" class="badge badge-dark">{{ votes[5] }}</span></button>
                    </div>

        <br><br>






                </div>
            </div>
        </div>

    </div>

    <div class="container">

        <!-- Trigger the modal with a button -->
        <button type="button" class="btn btn-info btn-lg" data-toggle="modal" data-target="#myModal">Show reacts</button>

        <!-- Modal -->
        <div class="modal fade" id="myModal" role="dialog" >
            <div class="modal-dialog"  >

                <!-- Modal content-->
                <div class="modal-content" >
                    <div class="modal-header" >

                        <ul class="nav nav-tabs" >
                            <li class="active" style="text-align: center;"><a  data-toggle="tab" href="#all">All {{ reacts[7][0][1]}}</a></li>
                            <li><a data-toggle="tab" href="#u1" ><img style="margin-right: 5px;" class="" id="upvote" width="20" src="{{ asset('uploads/forum/vote/upvote.png') }}">{{ votes[0] }}</a></li>
                            &nbsp; <li><a data-toggle="tab" href="#u2"><img style="margin-right: 5px;" class="" id="funny" width="20" src="{{ asset('uploads/forum/vote/funny.png') }}">{{ votes[1] }}</a></li>
                            &nbsp;<li><a data-toggle="tab" href="#u3"><img style="margin-right: 5px;" class="" id="love" width="20" src="{{ asset('uploads/forum/vote/love.png') }}">{{ votes[2] }}</a></li>
                            &nbsp;<li><a data-toggle="tab" href="#u4"><img style="margin-right: 5px;" class="" id="surprised" width="20" src="{{ asset('uploads/forum/vote/surprised.png') }}">{{ votes[3] }}</a></li>
                            &nbsp;<li><a data-toggle="tab" href="#u5"><img style="margin-right: 5px;" class="" id="upvote" width="20" src="{{ asset('uploads/forum/vote/angry.png') }}">{{ votes[4] }}</a></li>
                            <li><a data-toggle="tab" href="#u6"><img style="margin-right: 5px;" class="" id="upvote" width="20" src="{{ asset('uploads/forum/vote/sad.png') }}">{{ votes[5] }}</a></li>
                        </ul>

                    </div>
                    <div class="modal-body">
                        <div class="tab-content">
                            <div id="all" class="tab-pane fade in active ">

                                <tr>
                                    {% for i in reacts[6] %}
                                        <th>
                                            <h7><img id="img" src="{{ asset('uploads/forum/' ~ i.picture) }}" alt="" style="width: 50px;border-radius: 50%;">&nbsp;&nbsp;&nbsp;{{ i.username }}</h7><br>
                                        </th>
                                    {% endfor %}
                                </tr>


                            </div>
                            <div id="u1" class="tab-pane fade ">

                                <tr>
                                    {% for i in reacts[0] %}
                                        <th>
                                            <h7><img id="img" src="{{ asset('uploads/forum/' ~ i.picture) }}" alt="" style="width: 50px;border-radius: 50%;">&nbsp;&nbsp;&nbsp;{{ i.username }}</h7><br>
                                        </th>
                                    {% endfor %}
                                </tr>
                            </div>
                            <div id="u2" class="tab-pane fade ">

                                <tr>
                                    {% for i in reacts[1] %}
                                        <th>
                                            <h7><img id="img" src="{{ asset('uploads/forum/' ~ i.picture) }}" alt="" style="width: 50px;border-radius: 50%;">&nbsp;&nbsp;{{ i.username }}</h7><br>
                                        </th>
                                    {% endfor %}
                                </tr>
                            </div>
                            <div id="u3" class="tab-pane fade ">

                                <tr>
                                    {% for i in reacts[2] %}
                                        <th>
                                            <h7><img id="img" src="{{ asset('uploads/forum/' ~ i.picture) }}" alt="" style="width: 50px;border-radius: 50%;">&nbsp;&nbsp;&nbsp;{{ i.username }}</h7><br>
                                        </th>
                                    {% endfor %}
                                </tr>
                            </div>
                            <div id="u4" class="tab-pane fade ">

                                <tr>
                                    {% for i in reacts[3] %}
                                        <th>
                                            <h7><img id="img" src="{{ asset('uploads/forum/' ~ i.picture) }}" alt="" style="width: 50px;border-radius: 50%;">&nbsp;&nbsp;&nbsp;{{ i.username }}</h7><br>
                                        </th>
                                    {% endfor %}
                                </tr>
                            </div>
                            <div id="u5" class="tab-pane fade ">

                                <tr>
                                    {% for i in reacts[4] %}
                                        <th>
                                            <h7><img id="img" src="{{ asset('uploads/forum/' ~ i.picture) }}" alt="" style="width: 50px;border-radius: 50%;">&nbsp;&nbsp;&nbsp;{{ i.username }}</h7><br>
                                        </th>
                                    {% endfor %}
                                </tr>
                            </div>
                            <div id="u6" class="tab-pane fade ">

                                <tr>
                                    {% for i in reacts[5] %}
                                        <th>
                                            <h7><img id="img" src="{{ asset('uploads/forum/' ~ i.picture) }}" alt="" style="width: 50px;border-radius: 50%;">&nbsp;&nbsp;&nbsp;{{ i.username }}</h7><br>
                                        </th>
                                    {% endfor %}
                                </tr>
                            </div>
                        </div>
                    </div>
                    <div class="modal-footer">
                        <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
                    </div>
                </div>

            </div>
        </div>

    </div>

{#Commentaire#}
    <div class="blog-area section-padding-20">
        <div class="container">
            <div class="comment-top">
                <a onclick="myFunction()"  id="tet" style="padding-left: 900px;">Show/Hide comments</a>
                {% if comments|length == 0 %}
                <h4> No Comments</h4>

                {% elseif comments |length>0 %}
                <div class="container">
                    <div class="row">
                        <!-- Contenedor Principal -->
                        <div class="comments-container" id="hayaaad">
                            <h1>Number of Comments({{ nbcom }})</h1>

                            <ul id="comments-list" class="comments-list">

                                {% for comment in comments %}
                                    <li>
                                        <div class="comment-main-level" id="">
                                            <!-- Avatar -->
                                            <div class="comment-avatar" id="bz"><img id="imgg" src="{{ asset('uploads/forum/' ~ comment.idUser.picture) }}" alt=""></div>
                                            <!-- Contenedor del Comentario -->
                                            <div class="comment-box">
                                                <div class="comment-head">
                                                    <h6 class="comment-name"><a href="">{{ comment.idUser.username }}</a></h6>
                                                    <span>{{ comment.dateCom | date("m/d/Y")}}</span>

                                                </div>
                                                <div class="comment-content">
                                                    {{ comment.descriptionCom }}
                                                </div>
                                                <div>
                                                    {% if user.id == comment.idUser.id %}
                                                        <a href="{{ path('modifier_comment',{'id':comment.idCom}) }}"  class="generic-btn info-border radius"><i class="fa fa-edit" style="font-size:30px;"></i> </a>
                                                        <a onclick="supprimer({{ comment.idCom}})"  class="generic-btn info-border radius"><i class="fa fa-trash" style="font-size:30px;color:red"></i> </a>





                                                    {% endif %}
                                                </div>
                                            </div>

                                        </div>
                                    </li>
                                {% endfor %}
                                {% endif %}
                            </ul>
                            <div class="comment-top">
                                </br></br>
                                <h4>Leave a Comment</h4><br>
                                {{ form_start(form) }}
                                <div class="comment-bottom" >



                                   <input     {{form_widget(form.descriptionCom)}}




                                </div>

                                {{ form_end(form) }}
                            </div>
                        </div>
                    </div>
                </div>


            </div>





        </div>
        </div>


    </div>








    <style>


        /**
         * Oscuro: #283035
         * Azul: #03658c
         * Detalle: #c7cacb
         * Fondo: #dee1e3
         ----------------------------------*/
        * {
            margin: 0;
            padding: 0;
            -webkit-box-sizing: border-box;
            -moz-box-sizing: border-box;
            box-sizing: border-box;
        }

        a {
            color: #03658c;
            text-decoration: none;
        }

        ul {
            list-style-type: none;
        }

        body {
            font-family: 'Roboto', Arial, Helvetica, Sans-serif, Verdana;
            background: #dee1e3;
        }

        /** ====================
         * Lista de Comentarios
         =======================*/
        .comments-container {
            margin: 60px auto 15px;
            width: 768px;
        }

        .comments-container h1 {
            font-size: 36px;
            color: #283035;
            font-weight: 400;
        }

        .comments-container h1 a {
            font-size: 18px;
            font-weight: 700;
        }

        .comments-list {
            margin-top: 30px;
            position: relative;
        }

        /**
         * Lineas / Detalles
         -----------------------*/
        .comments-list:before {
            content: '';
            width: 2px;
            height: 100%;
            background: #c7cacb;
            position: absolute;
            left: 32px;
            top: 0;
        }

        .comments-list:after {
            content: '';
            position: absolute;
            background: #c7cacb;
            bottom: 0;
            left: 27px;
            width: 7px;
            height: 7px;
            border: 3px solid #dee1e3;
            -webkit-border-radius: 50%;
            -moz-border-radius: 50%;
            border-radius: 50%;
        }

        .reply-list:before, .reply-list:after {display: none;}
        .reply-list li:before {
            content: '';
            width: 60px;
            height: 2px;
            background: #c7cacb;
            position: absolute;
            top: 25px;
            left: -55px;
        }


        .comments-list li {
            margin-bottom: 15px;
            display: block;
            position: relative;
        }

        .comments-list li:after {
            content: '';
            display: block;
            clear: both;
            height: 0;
            width: 0;
        }

        .reply-list {
            padding-left: 88px;
            clear: both;
            margin-top: 15px;
        }
        /**
         * Avatar
         ---------------------------*/
        .comments-list .comment-avatar {
            width: 65px;
            height: 65px;
            position: relative;
            z-index: 99;
            float: left;
            border: 3px solid #FFF;
            -webkit-border-radius: 4px;
            -moz-border-radius: 4px;
            border-radius: 4px;
            -webkit-box-shadow: 0 1px 2px rgba(0,0,0,0.2);
            -moz-box-shadow: 0 1px 2px rgba(0,0,0,0.2);
            box-shadow: 0 1px 2px rgba(0,0,0,0.2);
            overflow: hidden;
        }

        .comments-list .comment-avatar img {
            width: 100%;
            height: 100%;
        }

        .reply-list .comment-avatar {
            width: 50px;
            height: 50px;
        }

        .comment-main-level:after {
            content: '';
            width: 0;
            height: 0;
            display: block;
            clear: both;
        }
        /**
         * Caja del Comentario
         ---------------------------*/
        .comments-list .comment-box {
            width: 680px;
            float: right;
            position: relative;
            -webkit-box-shadow: 0 1px 1px rgba(0,0,0,0.15);
            -moz-box-shadow: 0 1px 1px rgba(0,0,0,0.15);
            box-shadow: 0 1px 1px rgba(0,0,0,0.15);
        }

        .comments-list .comment-box:before, .comments-list .comment-box:after {
            content: '';
            height: 0;
            width: 0;
            position: absolute;
            display: block;
            border-width: 10px 12px 10px 0;
            border-style: solid;
            border-color: transparent #FCFCFC;
            top: 8px;
            left: -11px;
        }

        .comments-list .comment-box:before {
            border-width: 11px 13px 11px 0;
            border-color: transparent rgba(0,0,0,0.05);
            left: -12px;
        }

        .reply-list .comment-box {
            width: 610px;
        }
        .comment-box .comment-head {
            background: #FCFCFC;
            padding: 10px 12px;
            border-bottom: 1px solid #E5E5E5;
            overflow: hidden;
            -webkit-border-radius: 4px 4px 0 0;
            -moz-border-radius: 4px 4px 0 0;
            border-radius: 4px 4px 0 0;
        }

        .comment-box .comment-head i {
            float: right;
            margin-left: 14px;
            position: relative;
            top: 2px;
            color: #A6A6A6;
            cursor: pointer;
            -webkit-transition: color 0.3s ease;
            -o-transition: color 0.3s ease;
            transition: color 0.3s ease;
        }

        .comment-box .comment-head i:hover {
            color: #03658c;
        }

        .comment-box .comment-name {
            color: #283035;
            font-size: 14px;
            font-weight: 700;
            float: left;
            margin-right: 10px;
        }

        .comment-box .comment-name a {
            color: #283035;
        }

        .comment-box .comment-head span {
            float: left;
            color: #999;
            font-size: 13px;
            position: relative;
            top: 1px;
        }

        .comment-box .comment-content {
            background: #FFF;
            padding: 12px;
            font-size: 15px;
            color: #595959;
            -webkit-border-radius: 0 0 4px 4px;
            -moz-border-radius: 0 0 4px 4px;
            border-radius: 0 0 4px 4px;
        }

        .comment-box .comment-name.by-author, .comment-box .comment-name.by-author a {color: #03658c;}
        .comment-box .comment-name.by-author:after {
            content: 'autor';
            background: #03658c;
            color: #FFF;
            font-size: 12px;
            padding: 3px 5px;
            font-weight: 700;
            margin-left: 10px;
            -webkit-border-radius: 3px;
            -moz-border-radius: 3px;
            border-radius: 3px;
        }

        /** =====================
         * Responsive
         ========================*/
        @media only screen and (max-width: 766px) {
            .comments-container {
                width: 480px;
            }

            .comments-list .comment-box {
                width: 390px;
            }

            .reply-list .comment-box {
                width: 320px;
            }
        }


        .inner-img {
            transition: 0.3s;
        }

        .inner-img:hover {
            transform: scale(1.3);
        }

    </style>
    <style>
        .tooltip {
            position: relative;
            display: inline-block;
            border-bottom: 1px dotted black;
        }

        .tooltip .tooltiptext {
            visibility: hidden;
            width: 120px;
            background-color: black;
            color: #fff;
            text-align: center;
            border-radius: 6px;
            padding: 5px 0;

            /* Position the tooltip */
            position: absolute;
            z-index: 1;
        }

        .tooltip:hover .tooltiptext {
            visibility: visible;
        }
    </style>





    <script>





        function myFunction() {
            $("#hayaaad").slideToggle(1500);

        }





        function favoris(idforum){
            $.ajax({//verif fav
                url:'http://localhost/talandWEB/web/app_dev.php/Forum/veriffavoris/' + idforum,
                success:function (data) {
                    if (data=="alreadyadded"){
                        Swal.fire({
                            icon: 'error',
                            width:470,
                            title: 'Oops...',
                            text: 'Subject alreday added to your favorite list!',
                            timer: 3000,
                            timerProgressBar:true,
                            showConfirmButton:false
                        })

                    }
                    else {
                        //ajouter to fav
                        $.ajax({
                            url: 'http://localhost/talandWEB/web/app_dev.php/Forum/favoris/' + idforum ,
                            success: function (data) {
                                console.log("added to fav"+idforum);
                                Swal.fire({
                                    icon: 'success',
                                    title: 'Subject is added to your favorite list!',
                                    showConfirmButton: false,
                                    timer: 1500
                                })


                            },
                            error: function (xhr, textStatus, errorThrown) {
                                console.log("favoris request failed.");
                            }

                        });
                    }

                },
                error: function (xhr, textStatus, errorThrown) {
                    console.log("error.");
                }

            });

        }


        function vote(idforum,id) {
            $.ajax({//verifier
                url: 'http://localhost/talandWEB/web/app_dev.php/Forum/verifvote/' + idforum,
                success: function (data) {
                    if (data=="voted"){
                        //modifier
                        $.ajax({
                            url: 'http://localhost/talandWEB/web/app_dev.php/Forum/modifvote/' + idforum + '/' +id,
                            success: function (data) {
                                //location.reload();//https://www.youtube.com/results?search_query=go+dumb
                                window.location.replace(window.location.href);
                                document.getElementById("span1").style.display = "unset";
                                document.getElementById("span2").style.display = "unset";
                                document.getElementById("span3").style.display = "unset";
                                document.getElementById("span4").style.display = "unset";
                                document.getElementById("span5").style.display = "unset";
                                document.getElementById("span6").style.display = "unset";

                                console.log("modified"+idforum+" "+data+" "+id);
                            },
                            error: function (xhr, textStatus, errorThrown) {
                                console.log("modify request failed.");
                            }
                        });

                    }else{
                        //ajouter
                        $.ajax({
                            url: 'http://localhost/talandWEB/web/app_dev.php/Forum/vote/' + idforum + "/" + id,
                            success: function (data) {
                                var span = "span"+id;
                                var oldvalue=Number(document.getElementById(span).getAttribute("spanval"));

                                document.getElementById(span).innerText = oldvalue+1;
                                document.getElementById("span1").style.display = "unset";
                                document.getElementById("span2").style.display = "unset";
                                document.getElementById("span3").style.display = "unset";
                                document.getElementById("span4").style.display = "unset";
                                document.getElementById("span5").style.display = "unset";
                                document.getElementById("span6").style.display = "unset";

                                console.log(idforum+" "+data+" "+id);
                            },
                            error: function (xhr, textStatus, errorThrown) {
                                console.log("vote request failed.");
                            }
                        });
                    }

                },
                error: function (xhr, textStatus, errorThrown) {
                    console.log("verif request failed.");
                }
            });


        }
    </script>

    <script>

        function supprimer(idforum){swal({
            title: "Are you sure?",
            text: "Once deleted, you will not be able to recover this subject!",
            icon: "warning",
            buttons: true,
            dangerMode: true,
        })
            .then((willDelete) => {
                if (willDelete) {

                    $.ajax({//verif fav
                        url:'http://localhost/talandWEB/web/app_dev.php/Forum/supprimercomment/' + idforum,

                        success:function (data) {
                            if (data=="delete comment"){
                                console.log("delete success"+idforum);
                                window.location.replace(window.location.href);
                                // window.location.href("http://localhost/talandWEB/web/app_dev.php/Forum/afficherforums");

                            }




                            else {

                            }

                        },
                        error: function (xhr, textStatus, errorThrown) {
                            console.log("error.");
                        }

                    });
                } else {

                }
            });


        }
    </script>



    <script src="https://cdn.jsdelivr.net/npm/promise-polyfill"></script>
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@9"></script>
    <script src="https://unpkg.com/sweetalert/dist/sweetalert.min.js"></script>





{% endblock  %}